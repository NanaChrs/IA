<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8>
		<title>My first three.js app</title>
		<style>
			#container {
				position : relative;
			}

			#canvas {
				position : absolute;
				left : 0;
				top : 0;
			}
		</style>
	</head>


	<body>
		<script src="three.js"></script>
		<!---<script src="script.js"></script>-->
		<script src="https://www.auduno.com/clmtrackr/examples/js/libs/utils.js"></script>
		<script src="https://www.auduno.com/clmtrackr/build/clmtrackr.js"></script>
		<div id="container">
				<video id="videoElement" width="368" height="288" autoplay loop playsinline>
					
				</video>
				<canvas id="canvas" width="368" height="288"></canvas>
		</div>
		<p>Printing coordinates of the first 10 points in facial features:</p>
		<p id="positions"></p>
		<script>
			var video=document.getElementById("videoElement");

			if (navigator.mediaDevices.getUserMedia) {       
			    navigator.mediaDevices.getUserMedia({video: true})
			  .then(function(stream) {
			    video.srcObject = stream;
			  })
			  .catch(function(err0r) {
			    console.log("Something went wrong!");
			  });
			}

			var videoInput = document.getElementById('videoElement');

				var ctracker = new clm.tracker();
				ctracker.init();
				ctracker.start(videoInput);

				function positionLoop() {
					requestAnimFrame(positionLoop);
					var positions = ctracker.getCurrentPosition();
					// do something with the positions ...
					// print the positions
					var positionString = "";
					if (positions) {
						for (var p = 0;p < 30;p++) {
							positionString += "featurepoint "+p+" : ["+positions[p][0].toFixed(2)+","+positions[p][1].toFixed(2)+"]<br/>";
						}
						document.getElementById('positions').innerHTML = positionString;
					}
				}
				positionLoop();

				var canvasInput = document.getElementById('canvas');
				var cc = canvasInput.getContext('2d');
				function drawLoop() {
					requestAnimFrame(drawLoop);
					cc.clearRect(0, 0, canvasInput.width, canvasInput.height);
					ctracker.draw(canvasInput);
				}
				drawLoop();

		</script>
	</body>
</html>